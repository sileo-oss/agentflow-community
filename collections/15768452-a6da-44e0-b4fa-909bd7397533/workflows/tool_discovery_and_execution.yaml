name: Tool Discovery and Execution
description: A workflow to discover available tools, get user input for arguments, and execute the chosen tool.
diagram: |
  flowchart TD
      discover_tools --> present_tools
      present_tools --> process_tool_choice
      process_tool_choice --> get_tool_arguments
      get_tool_arguments --> process_tool_arguments
      process_tool_arguments --> execute_tool
      execute_tool --> process_another_tool_choice
      process_another_tool_choice -- "yes" --> present_tools
      process_another_tool_choice -- "no" --> end_workflow
steps:
  - name: discover_tools
    description: Inspect the environment to find all available tools and their signatures.
    actions:
      - "Explain that the agent will inspect all available tools (built-in and via MCP)."
      - "Inspect the environment to find all available tools and their signatures."
    user_prompt: "I will now inspect the available tools. Please wait."
    context:
      read_keys: []
      write_keys:
        - available_tools
    allowed_next_steps:
      - present_tools
    continuation_logic: "After discovering the tools, proceed to present them to the user."
    success_condition: "The list of available tools has been successfully generated."

  - name: present_tools
    description: Present the list of tools to the user and ask for their choice.
    actions:
      - "Present the list of available tools to the user as a numbered list, showing tool name, and for each argument, its name and whether it is mandatory or optional."
    user_prompt: "Here are the available tools:
[List of tools with arguments and their mandatory/optional status]
Please choose a tool to use by entering its number or name."
    context:
      read_keys:
        - available_tools
      write_keys:
        - user_tool_choice
    allowed_next_steps:
      - process_tool_choice
    continuation_logic: "Wait for user to choose a tool, then proceed to process the choice."
    success_condition: "The user has provided their choice of tool from the list."

  - name: process_tool_choice
    description: Process the user's tool choice.
    actions:
      - "Process the user's input to identify the chosen tool."
    context:
      read_keys:
        - user_tool_choice
      write_keys:
        - chosen_tool
    allowed_next_steps:
      - get_tool_arguments
    continuation_logic: "After processing the user's choice, proceed to get the tool's arguments."
    success_condition: "The user's tool choice has been successfully processed."

  - name: get_tool_arguments
    description: Get all mandatory arguments for the selected tool from the user.
    actions:
      - "Identify the mandatory arguments for the chosen tool."
      - "Prompt the user to provide a value for each mandatory argument."
    user_prompt: "Please provide the following arguments for the selected tool:"
    context:
      read_keys:
        - chosen_tool
      write_keys:
        - user_tool_arguments
    allowed_next_steps:
      - process_tool_arguments
    continuation_logic: "Wait for user to provide arguments, then proceed to process them."
    success_condition: "The user has provided arguments for the chosen tool."

  - name: process_tool_arguments
    description: Process the user-provided tool arguments.
    actions:
      - "Process the user's input to capture the tool arguments."
    context:
      read_keys:
        - user_tool_arguments
      write_keys:
        - tool_arguments
    allowed_next_steps:
      - execute_tool
    continuation_logic: "Once all mandatory arguments are processed, proceed to execute the tool."
    success_condition: "All mandatory arguments for the chosen tool have been successfully processed."

  - name: execute_tool
    description: Execute the chosen tool with the provided arguments, present the result to the user, and ask if they want to use another tool.
    actions:
      - "Execute the chosen tool with the provided arguments."
      - "Present the result of the tool execution to the user."
      - "Ask the user if they want to use another tool."
    user_prompt: "Do you want to use another tool? (yes/no)"
    context:
      read_keys:
        - chosen_tool
        - tool_arguments
      write_keys:
        - user_choice
    allowed_next_steps:
      - process_another_tool_choice
    continuation_logic: "After executing the tool and asking the user, proceed to process their choice."
    success_condition: "The chosen tool has been executed, the result presented, and the user has responded whether they want to use another tool."

  - name: process_another_tool_choice
    description: Process the user's choice to use another tool.
    actions:
      - "Process the user's 'yes' or 'no' response."
    context:
      read_keys:
        - user_choice
      write_keys: []
    allowed_next_steps:
      - present_tools
      - end_workflow
    continuation_logic: "If the user says 'yes', go back to the 'present_tools' step. Otherwise, end the workflow."
    success_condition: "The user's choice to use another tool has been processed."

  - name: end_workflow
    description: "This is the final step of the workflow."
    actions:
      - "The workflow has ended."
    context:
      read_keys: []
      write_keys: []
    allowed_next_steps: []
    continuation_logic: "This is the final step."
    success_condition: "The workflow has successfully ended."